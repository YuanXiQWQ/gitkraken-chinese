# **GitKraken 基础操作**

> GitKraken 常用基础操作 by [@YuanXiQWQ](https://github.com/YuanXiQWQ)
> 
> 本文仅为个人经验，仅供参考

# **名词**

## **本地（Local）**

## **![][image1]**

显示为电脑图标，真正保存在本地设备的内容

## **远程（Remote）**

## **![][image2]**

显示为用户头像，位于存储库的内容  
当本地与远程同步时，两个图标会同时显示  
![][image3]

## **强制推送（Force Push）**

破坏性操作。当本地历史与远程历史不兼容时（不符合快速前进 P1=\>P2=\>P3 关系），需使用强推。

---

# **顶部**

![][image4]

## **![][image5]撤销（Undo）**

撤销你上一步的操作。  
比如，上一步你做了提交，把暂存的提交提交到了本地，则撤销会让**本地**的提交回到**暂存**  
再比如，你提交后已经推送到了远程，则可以撤销**本地到暂存**，然后强制推送本地到远程，这样远程就也回退一步

1. **本地：ce5ba2；远程：ce5ba2**

2. 撤销本地到暂存  
   ![][image6]
3. 此时本地被撤销到了暂存，而远程不会变（撤销是本地操作）。  
   **本地：b87d29；远程：ce5ba2 （本地退一步）**  
   ![][image7]
4. 将已经退一步的本地强制推送，则此时远程也会相应退一步  
   因为**本地**落后于**远程**，因此推送需要强制推送![][image8]![][image9]  
   ![][image10]
5. 推送后，**本地：b87d29；远程：b87d29**   
   ![][image11]

## **![][image12]推送（Push）**

推送**本地**（而非暂存）到**远程**

## **![][image13]分支（Branch）**

在检出的提交创建分支（通过右键还可以在某个特定提交创建分支）

## **![][image14][贮藏（Stash）](https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E8%B4%AE%E8%97%8F%E4%B8%8E%E6%B8%85%E7%90%86)**

若当前已有未暂存的文件，想要切换到分支而不提交当前已修改内容，则可使用贮藏。

1. 当前分支已有未暂存修改，想要切换分支，但是又不想为此创建一个提交，而直接检出又会导致冲突（Conflict）

   ![][image15]

2. 贮藏更改  
   ![][image16]
3. 此时可以安全检出而无冲突  
   ![][image17]

   贮藏的提交可以通过右键删除。

## **![][image18]弹出（Pop）**

别的分支弄好了，要回来继续操作修改的文件，则将贮藏的内容弹出后可以继续修改

---

# **检出（Check Out）**

# **![][image19]**

检出分为两种：检出到分支（最终位于branch）、检出到提交（最终位于HEAD）

### 检出到分支：

前面贮藏提到过，双击分支标签（无论本地/远程），则检出到对应分支

### 检出到提交：

一段线性提交同属于同一分支，若检出到分支，只会检出到当前分支的最新提交。如何检出到该分支的某一条历史提交？  
本例中，位于分支master，最新提交为8297e8，期望检出提交为9e39d2  
![][image20]

1. 对着要检出的提交右键-检出到此提交  
   ![][image21]
2. 则此时已检出当前分支到游离HEAD（不指向真正远程的临时分支指针）  
   ![][image22]

---

# **右键菜单**

![][image23]

## **在此处创建分支**

从某一特定提交创建分支

## **重置 xxx 到此提交**

移动本地分支的指针到某一提交（若推送，则同时会移动远程，但需强推（本地落后于远程））  
![][image24]

|      模式      | HEAD（提交指针） | 暂存区（Index） | 工作区（Working Directory） | 是否丢文件 |
|:------------:|:----------:|:----------:|:----------------------:|:-----:|
|   **软重置**    |     回退     |     保留     |           保留           |   否   |
| **混合重置（默认）** |     回退     |     重置     |           保留           |   否   |
|   **硬重置**    |     回退     |     重置     |           重置           |   是   |

## **编辑提交信息**

对于已经提交到本地的commit，仍可以修改提交信息。对于已经推送到远程的commit，可以在本地修改完提交信息后强推到远程

## **从 xxx 向 xxx 发起拉取请求（PR）**

与 GitHub 上的 PR 操作相同，选中某一个分支向另一个分支提交请求。

## **将 xxx 合并到 xxx**

考虑如下情形：  
![][image25]  
要将分支2的改动添加到分支1，可以选择合并（Merge）

1. 检出到分支1
2. 右键分支2
3. 将 分支2 合并到 分支1  
   ![][image26]
4. 推送 分支1 到远程  
   ![][image27]

## **将 xxx 变基到 xxx**

同样上述情形，  
要将 分支2 的改动添加到 分支1，**而保留线性历史**，可以选择变基（Rebase）

1. 检出到分支1
2. 右键分支2
3. 将 分支1 变基到 分支2  
   ![][image28]
4. 强制推送 分支1 到远程  
   ![][image29]
5. 得到线性提交

![][image30]

## **[交互式变基（Interactive Rebase）](https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2.html#_changing_multiple)**

考虑如下情形：  
![][image31]

* 多余的提交想要丢弃
* 两个提交2想要合并
* 提交3想要放到提交2之后

解决方案：这些改动都在提交1之后，因此从提交1开始交互式变基

1. 在 提交1 右键，进入“交互式变基 4 个子提交到 1ea189（提交1的SHA）”  
   ![][image32]
2. 交互式变基：

* 丢弃：Drop
* 合并：Squash \=\> Reword
* 保留：Pick
* 重排序：拖动  
  ![][image33]

4\. 开始变基并强制推送  
![][image34]  
![][image35]  
如果不希望被合并的提交的提交概要被放入合并的提交的提交描述中，可以在变基时右键合并提交-修改提交信息  
![][image36]  
或者从右侧提交详情处修改提交信息  
![][image37]

## **[拣选（Cherry Pick）](https://git-scm.com/book/zh/v2/%e5%88%86%e5%b8%83%e5%bc%8f-Git-%e7%bb%b4%e6%8a%a4%e9%a1%b9%e7%9b%ae#_rebase_cherry_pick)提交**

考虑如下情形：  
![][image38]  
想要将 分支2 的 提交4、提交5 “选”到 分支1 的 提交3 后：使用拣选

1. 检出 分支1
2. 分别对 提交4、提交5 右键-拣选提交  
   ![][image39]
3. 推送  
   ![][image40]

## **快速前进 xxx 到 xxx**

移动分支指针而不产生提交

## **重命名 xxx 分支（一般本地和origin都要同步）**

将本地/远程的分支重命名

## **删除 xxx 分支**

本地和远程删除都是破坏性操作。如果已经合并了，删除的就是分支本身，而分支带来的修改不会被删除。如果没合并，则分支修改丢失。

## **在此处创建标签**

用于给某阶段更改创建标签。可以用来检出，也可以用来给 GitHub Action 做标记。

## **在此处创建注解标签**

带注解的标签

---

# **左侧框**

![][image41]

## **本地（Local）**

显示下载到本地的分支

## **远程（Remote）**

远程Git库实际存在的所有分支

* ![][image42]可以用远程旁边的 \+ 添加一个远程
    * 一般会选择GitHub，然后选择你的账号，新建存储库，然后把本地的内容推送过去。还可以自动创建README和License

## **拉取请求（Pull Request）**

可以在这里创建拉取请求，不过更多的是查看已经提交的拉取请求。一般在右键菜单那里通过“从 xxx 分支向 dev/main/xxx
提交拉取请求”直接创建。提交之后就可以在这里看到。

## **问题（Issue）**

公共库常用，别人提出的 Issue 会显示在这里，并且可以在这里解决

## **GitHub动作**

用于写 GitHub 工作流，比如自动释放，自动build等等

---

# **右侧**

## ![][image43]**查看文件更改**

若工作区有新更改，则会在这里显示

## **![][image44]放弃所有更改**

爷不要了！

## **暂存（Stage）**

与贮藏（Stash）不同，暂存是提交（Commit）的候选区，用于整理、控制历史、提交前检查等

## **忽略**

将已选内容放入 .gitignore 并停止跟踪（可选）

## **修改上一次提交**

![][image45]  
如果本次提交只是对前一次提交的补充，使用此选项可以免去一次交互式变基的合并操作。如果前一次提交已推送到远程，则需要强制推送。

## **概要与描述**

![][image46]  
![][image47]  
![][image48]  
Commit 的大字和小字

---

# **![][image49][冲突（Conflict）](https://docs.github.com/zh/pull-requests/collaborating-with-pull-requests/addressing-merge-conflicts/about-merge-conflicts)**

当对文件的同一行进行竞争更改时，或者当一个人编辑文件而另一个人删除同一文件时，会发生合并冲突。常见于：

* 合并
* 变基
* 弹出贮藏
* 挑拣

## **冲突页面**

![][image50]  
点击进入冲突文件  
![][image51]  
左分支：被合并分支  
![][image52]  
右分支：合并分支  
![][image53]  
输出：最终解决文件  
![][image54]  
冲突页面总览：  
![][image55]

### ![][image56]接受行

以行为单位接受代码

### ![][image57]接受块

以代码块为单位接受代码

### ![][image58]接受文件

接受整个文件

## **解决冲突**

本例中，我们决定：

1. 场景一：我们只想取一边 \=\> 接受左行
2. 场景二：我们只想取一边 \=\> 接受右块
3. 场景三：我们两个都想要 \=\> 接受两边
4. 场景四：两方法互斥，但我们需要一个方法来解决两边的数据 \=\> 重写方法

   ![][image59]

5. 解决冲突后，![][image60]保存，并解决下一个冲突文件
6. 全部解决后，继续合并/变基等操作

![][image61]

[image1]: ./imgs/1.png

[image2]: ./imgs/2.png

[image3]: ./imgs/3.png

[image4]: ./imgs/4.png

[image5]: ./imgs/5.png

[image6]: ./imgs/6.png

[image7]: ./imgs/7.png

[image8]: ./imgs/8.png

[image9]: ./imgs/9.png

[image10]: ./imgs/10.png

[image11]: ./imgs/11.png

[image12]: ./imgs/12.png

[image13]: ./imgs/13.png

[image14]: ./imgs/14.png

[image15]: ./imgs/15.png

[image16]: ./imgs/16.png

[image17]: ./imgs/17.png

[image18]: ./imgs/18.png

[image19]: ./imgs/19.png

[image20]: ./imgs/20.png

[image21]: ./imgs/21.png

[image22]: ./imgs/22.png

[image23]: ./imgs/23.png

[image24]: ./imgs/24.png

[image25]: ./imgs/25.png

[image26]: ./imgs/26.png

[image27]: ./imgs/27.png

[image28]: ./imgs/28.png

[image29]: ./imgs/29.png

[image30]: ./imgs/30.png

[image31]: ./imgs/31.png

[image32]: ./imgs/32.png

[image33]: ./imgs/33.png

[image34]: ./imgs/34.png

[image35]: ./imgs/35.png

[image36]: ./imgs/36.png

[image37]: ./imgs/37.png

[image38]: ./imgs/38.png

[image39]: ./imgs/39.png

[image40]: ./imgs/40.png

[image41]: ./imgs/41.png

[image42]: ./imgs/42.png

[image43]: ./imgs/43.png

[image44]: ./imgs/44.png

[image45]: ./imgs/45.png

[image46]: ./imgs/46.png

[image47]: ./imgs/47.png

[image48]: ./imgs/48.png

[image49]: ./imgs/49.png

[image50]: ./imgs/50.png

[image51]: ./imgs/51.png

[image52]: ./imgs/52.png

[image53]: ./imgs/53.png

[image54]: ./imgs/54.png

[image55]: ./imgs/55.png

[image56]: ./imgs/56.png

[image57]: ./imgs/57.png

[image58]: ./imgs/58.png

[image59]: ./imgs/59.png

[image60]: ./imgs/60.png

[image61]: ./imgs/61.png